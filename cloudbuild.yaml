steps:
- name: 'gcr.io/cloud-builders/docker'
  args: ['build', '-t', 'gcr.io/aktivio-development/aktivio-backend', '.']
- name: 'gcr.io/cloud-builders/docker'
  args: ['push', 'gcr.io/aktivio-development/aktivio-backend']
- name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
  entrypoint: 'gcloud'
  args:
    - 'run'
    - 'deploy'
    - 'aktivio-backend'
    - '--image'
    - 'gcr.io/aktivio-development/aktivio-backend'
    - '--platform'
    - 'managed'
    - '--region'
    - 'asia-southeast2'
    - '--allow-unauthenticated'
    - '--set-env-vars'
    - 'SERVICE_ACCOUNT_JSON=${_SERVICE_ACCOUNT_JSON},ALGOLIA_APPLICATION_ID=XF4QR89Z7C,ALGOLIA_ADMIN_API_KEY=583fee7b08443a9b7659ced340fc3e96'
substitutions:
  _SERVICE_ACCOUNT_JSON: '{"type":"service_account","project_id":"aktivio-development","private_key_id":"a0cf417b0aceb48229e7a015127782bc14d41b21","private_key":"-----BEGIN PRIVATE KEY-----\\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCVJ0+e5QcxvjUP\\n2E/HWWXhJf9KN9TAoARrc8nsdgZ2JtB2ZtqlD/xYeM3NNDNAofN8e4oDrYRGEX0o\\nm3nyBZ9E7wR3QQb7cVGT5vf8Fivg7IDaoaLn0l2Dc4n4UkUdRuYaYnv0MZFwLcYo\\nxWIn1Z2K4uiTqIhnFTCcHKaS4GKtCfYjfCAphcRx1f7ivnf+ft0FDT/94LdUP4Q2\\nX9bIYslMq2A8YS6IbrxwlzuaUOkU20xI/VdZO7LHlNYxDgkf4nx9/wIdDLMtgQ5Y\\nXt5KpJShLPXB8Dj2pZ4jQG2Cbt44QbJOEH4wtwaMZ5jGIisYRT35RIvH34vGJ+PX\\nQBIY8nFrAgMBAAECggEAFklsy5tWpdzRZPAM4Qa/WGiAawCeA7e6sVZN4ngITc34\\nRu47gX/lVFBIwCl/9wpmrZUaxviTKT0ibII+3dEalAb7Ay7DnP1jvoE7+35R9Cai\\nt7MrT7nOoKkPq/vvDomHhy3BbnhG+RzTMp270E6ftHRkuEZDNilOaCVH0UPsuq+Q\\nnXhOm6yA8yJlIp6EXtolhp/vvLNiA71HNpCKVMHCJgBZ2N/PqxEfTDbWbQealHz4\\nifnmVez9ABfF+uFlWBxyDYzEdd291ZqmNMI+E7x3LIxn6Kdh2s18UAw5WiAwy0E4\\nzhUqpZJ+LU1HyFhOzOelxYlqBu8X8c1SQtJ/8CdJ0QKBgQDIy9I0rrgUtWyxxM8d\\n610pQ+ie+zU2RJfbE5qHzBNQvgsCqGc0+pwxOnusUEgh1sFtu1vW5c0garTOMxmM\\nv9uyXId4GJ71NrOALVowTsrQCZgB8MocVBc8KXviCuXpDm/Ig32Se55HvASoOGqk\\n/YpGeUeIhipY5ADPUyg50RC8LwKBgQC+KNhu4ysMp3Zq3/hWFTErGUXsphScdqfP\\nYIHWt0Ih2+yMHRducCgfioIJf3NKggec4I8tQRCynHeVUOlGFRL8Ib3lTlpes8eV\\nHq9ZAWDqb8mJxlPCi3bBi62tcUFkQ5QB5R4U7Dn8tMtxysPMTr3BSQqrla53TL5+\\nNo2wyg3jhQKBgDsh6xGgso1GsG/ZqbUB7zmLyiGnkRAeOypFJ6j+LGIG1W8+8MXl\\nV8IXmvwv2E4+1E/gcTdkDXiSdBSVb9zHU4e/QBXaClXkehAxSvIXAhsp+B36L0sQ\\naJdLEDSNSQ/NNJY0QvK0fPRbJnPzyVQ1ZldCuBI4kJgE7UghESOVsfv5AoGAFvgA\\nDITL8l9X4ljjOiKdKcOHuqnk23FJm7bgd/rytfxGejYZWnGZpxWn11XZqypBmSVW\\npfSx+6ECoLqBMsHg5St+MHBiYgX9GXn3XBzag/a0tTuLanhGA+LHO6fuahnvirsO\\nAyD1cBy2ZixDsi3gpbQY4djWlfpjGAOm4a/GNbECgYA7ODGk99SsrttmAqUc8sjg\\nIRULYh5OxV6L8rDuyQlgyUEj6BPIvHEwLI+wfzfgm+Y1ixKJ6RQfGk43t44V8ElD\\n3Q0UR4re36BAB/k7CNJ36GEv/YDfhArI8ii0vM5EuzEBTCSCVLoO9bich21rr6rt\\nCXv2dwnM0aHr0T9EppmAMg==\\n-----END PRIVATE KEY-----\\n","client_email":"firebase-adminsdk-4qmbd@aktivio-development.iam.gserviceaccount.com","client_id":"105600146972848074755","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-4qmbd%40aktivio-development.iam.gserviceaccount.com","universe_domain":"googleapis.com"}'